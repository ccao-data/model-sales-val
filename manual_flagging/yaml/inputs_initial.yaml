# This file contains relevant inputs for the initial_flagging.py script,
# which will (ideally) be run one time when we first populate the flagging
# tables in Athena.
---

# This value can either be 'res_single_family', 'res_multi_family',
# 'condos'
housing_run_type: ["res_single_family", "res_multi_family", "condos"]

housing_run_type_filters:
  res_single_family: [
    "202",
    "203",
    "204",
    "205",
    "206",
    "207",
    "208",
    "209",
    "210",
    "218",
    "219",
    "234",
    "278",
    "295"
  ]
  res_multi_family: ["211", "212"]
  condos: ["297", "299", "399"]

stat_groups:
  current:
    res_single_family:
      columns:
        - "rolling_window"
        - "geography_split"
        - "bldg_age_bin"
        - "char_bldg_sf_bin"
      sf_bin_specification: [1200, 2400]
      age_bin_specification: [40]
    res_multi_family:
      columns:
        - "rolling_window"
        - "geography_split"
        - "bldg_age_bin"
      age_bin_specification: [20]
    condos:
      columns:
        - "rolling_window"
        - "geography_split"
  og_mansueto:
    res_single_family:
      columns:
        - "rolling_window"
        - "township_code"
        - "class"
    res_multi_family:
      columns:
        - "rolling_window"
        - "township_code"
        - "class"
    condos:
      columns:
        - "rolling_window"
        - "township_code"

run_tri: [1, 2, 3]

tri_stat_groups:
  # city
  1: "current"
  # north
  2: "og_mansueto"
  # south
  3: "og_mansueto"

iso_forest:
  res: [
    "meta_sale_price",
    "sv_price_per_sqft",
    "sv_days_since_last_transaction",
    "sv_cgdr",
    "sv_sale_dup_counts"
  ]
  condos: [
    "meta_sale_price",
    "sv_days_since_last_transaction",
    "sv_cgdr",
    "sv_sale_dup_counts"
  ]

dev_bounds: [2, 2]

# 'start' and 'end' determine which sales will be written to the
# sale.flag table. Leave 'end' blank if we want to flag all sales
# since the start date
time_frame:
  start: "2018-01-01"
  end:

# How many total months to include in the grouping methodology
rolling_window_months: 12

# PTAX flags are only kept if the raw or sqft price is at least this
# many standard deviations away from the mean
ptax_sd: [1, 1]

# Flags are only applied if there are at least this many sales in the group
min_groups_threshold: 30
